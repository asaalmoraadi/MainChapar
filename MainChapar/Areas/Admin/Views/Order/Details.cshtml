@model MainChapar.Models.PickupRequest

<h2>جزئیات سفارش شماره @Model.Id</h2>

<div>
    <h4>اطلاعات کاربر</h4>
    <p><strong>نام کامل:</strong> @Model.User?.UserName</p>
    <p><strong>ایمیل:</strong> @Model.User?.Email</p>
    <p><strong>تاریخ ثبت سفارش:</strong> @Model.CreatedAt.ToString("yyyy/MM/dd HH:mm")</p>
    <p><strong>وضعیت تحویل:</strong> @(Model.IsDelivered ? "تحویل شده" : "تحویل نشده")</p>
</div>

<hr />

<div>
    <h4>محصولات سفارش داده شده</h4>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>نام محصول</th>
                <th>تعداد</th>
                <th>قیمت واحد</th>
                <th>قیمت کل</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.ProductItems)
            {
                <tr>
                    <td>@item.Product?.Title</td>
                    <td>@item.Quantity</td>
                    <td>@String.Format("{0:N0} تومان", item.Product?.Price)</td>
                    <td>@String.Format("{0:N0} تومان", item.Product?.Price * item.Quantity)</td>
                </tr>
            }
        </tbody>
    </table>

    <h5 class="text-right">
        مجموع کل: @String.Format("{0:N0} تومان",
        Model.ProductItems.Where(od => od.Product != null)
        .Sum(od => od.Product.Price * od.Quantity))

    </h5>
</div>

<hr />

<div>
    <a asp-area="Admin" asp-controller="Order" asp-action="Index" class="btn btn-secondary">بازگشت به لیست سفارش‌ها</a>

    @if (Model.IsDelivered)
    {
        <form method="post" asp-area="Admin" asp-controller="Order" asp-action="MarkAsCollected" asp-route-id="@Model.Id" style="display:inline">
            <button type="submit" class="btn btn-warning">علامت‌گذاری تحویل شده</button>
        </form>
    }
</div>
